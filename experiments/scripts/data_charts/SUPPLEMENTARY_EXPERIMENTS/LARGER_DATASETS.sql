-- #### #### SUPPLEMENTARY EXPERIMENTS #### ####
-- #### EXTRA FIGURE 1 - LARGER DATASETS - PART 1 - SPEEDUPS KMEANS ####
WITH T_CPU AS (                                                 
	SELECT
		Y.VL_TOTAL_EXECUTION_TIME,
		Y.VL_INTER_TASK_EXECUTION_TIME,
		Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
		Y.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
		Y.VL_COMMUNICATION_TIME,
		(Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC + Y.VL_COMMUNICATION_TIME) AS VL_INTRA_TASK_EXECUTION_TIME_FREE_ADDITIONAL,
		(Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC+Y.VL_ADDITIONAL_TIME) AS VL_INTRA_TASK_EXECUTION_TIME_FREE_COMMUNICATION,
		Y.ID_PARAMETER,
		Y.CD_PARAMETER,
		Y.CD_CONFIGURATION,
		Y.ID_ALGORITHM,
		Y.DS_ALGORITHM,
		Y.ID_FUNCTION,
		Y.DS_FUNCTION,
		Y.ID_DEVICE,
		Y.DS_DEVICE,
		Y.ID_DATASET,
		Y.ID_RESOURCE,
		Y.ID_PARAMETER_TYPE,
		Y.DS_PARAMETER_TYPE,
		Y.DS_PARAMETER_ATTRIBUTE,
		Y.NR_ITERATIONS,
		Y.VL_GRID_ROW_DIMENSION,
		Y.VL_GRID_COLUMN_DIMENSION,
		Y.VL_BLOCK_ROW_DIMENSION,
		Y.VL_BLOCK_COLUMN_DIMENSION,
		Y.VL_BLOCK_MEMORY_SIZE,
		Y.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
		Y.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
		Y.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		Y.DS_RESOURCE,
		Y.NR_NODES,
		Y.NR_COMPUTING_UNITS_CPU,
		Y.NR_COMPUTING_UNITS_GPU,
		Y.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
		Y.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
		Y.NR_CONCAT_NODES_TOTAL_COMPUTING_UNITS_CPU_GPU,
		Y.DS_DATASET,
		Y.VL_DATASET_MEMORY_SIZE,
		Y.DS_DATA_TYPE,
		Y.VL_DATA_TYPE_MEMORY_SIZE,
		Y.VL_DATASET_DIMENSION,
		Y.VL_DATASET_ROW_DIMENSION,
		Y.VL_DATASET_COLUMN_DIMENSION,
		Y.NR_RANDOM_STATE
		FROM
		(
			SELECT
			AVG(X.VL_TOTAL_EXECUTION_TIME) AS VL_TOTAL_EXECUTION_TIME,
			AVG(X.VL_INTER_TASK_EXECUTION_TIME) AS VL_INTER_TASK_EXECUTION_TIME,
			AVG(X.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
			AVG(X.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
			AVG(X.VL_COMMUNICATION_TIME_1) AS VL_COMMUNICATION_TIME_1,
			AVG(X.VL_COMMUNICATION_TIME_2) AS VL_COMMUNICATION_TIME_2,
			AVG(X.VL_COMMUNICATION_TIME) AS VL_COMMUNICATION_TIME,
			AVG(X.VL_ADDITIONAL_TIME_1) AS VL_ADDITIONAL_TIME_1,
			AVG(X.VL_ADDITIONAL_TIME_2) AS VL_ADDITIONAL_TIME_2,
			AVG(X.VL_ADDITIONAL_TIME) AS VL_ADDITIONAL_TIME,
			X.ID_PARAMETER,
			X.CD_PARAMETER,
			X.CD_CONFIGURATION,
			X.ID_ALGORITHM,
			X.DS_ALGORITHM,
			X.ID_FUNCTION,
			X.DS_FUNCTION,
			X.ID_DEVICE,
			X.DS_DEVICE,
			X.ID_DATASET,
			X.ID_RESOURCE,
			X.ID_PARAMETER_TYPE,
			X.DS_PARAMETER_TYPE,
			X.DS_PARAMETER_ATTRIBUTE,
			X.NR_ITERATIONS,
			X.VL_GRID_ROW_DIMENSION,
			X.VL_GRID_COLUMN_DIMENSION,
			X.VL_GRID_ROW_X_COLUMN_DIMENSION,
			X.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
			X.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
			X.VL_BLOCK_ROW_DIMENSION,
			X.VL_BLOCK_COLUMN_DIMENSION,
			X.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
			X.VL_BLOCK_MEMORY_SIZE,
			X.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
			X.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
			X.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
			X.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
			X.DS_RESOURCE,
			X.NR_NODES,
			X.NR_COMPUTING_UNITS_CPU,
			X.NR_COMPUTING_UNITS_GPU,
			X.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
			X.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
			X.NR_CONCAT_NODES_TOTAL_COMPUTING_UNITS_CPU_GPU,
			X.DS_DATASET,
			X.VL_DATASET_MEMORY_SIZE,
			X.DS_DATA_TYPE,
			X.VL_DATA_TYPE_MEMORY_SIZE,
			X.VL_DATASET_DIMENSION,
			X.VL_DATASET_ROW_DIMENSION,
			X.VL_DATASET_COLUMN_DIMENSION,
			X.VL_DATASET_ROW_X_COLUMN_DIMENSION,
			X.NR_RANDOM_STATE
			FROM
			(
				SELECT
					A.ID_EXPERIMENT,
					A.VL_TOTAL_EXECUTION_TIME,
					A.VL_INTER_TASK_EXECUTION_TIME,
					A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
					A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
					A.VL_COMMUNICATION_TIME_1,
					A.VL_COMMUNICATION_TIME_2,
					A.VL_COMMUNICATION_TIME_1 + A.VL_COMMUNICATION_TIME_2 AS VL_COMMUNICATION_TIME,
					A.VL_ADDITIONAL_TIME_1,
					A.VL_ADDITIONAL_TIME_2,
					A.VL_ADDITIONAL_TIME_1 + A.VL_ADDITIONAL_TIME_2 AS VL_ADDITIONAL_TIME,
					A.DT_PROCESSING,
					B.ID_PARAMETER,
					B.CD_PARAMETER,
					B.CD_CONFIGURATION,
					B.ID_ALGORITHM,
					(SELECT DISTINCT X.DS_ALGORITHM FROM schema_dev.ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) AS DS_ALGORITHM,
					B.ID_FUNCTION,
					(SELECT DISTINCT X.DS_FUNCTION FROM schema_dev.FUNCTION X WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_FUNCTION,
					(SELECT DISTINCT Y.ID_DEVICE FROM schema_dev.FUNCTION X INNER JOIN schema_dev.DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS ID_DEVICE,
					(SELECT DISTINCT Y.DS_DEVICE FROM schema_dev.FUNCTION X INNER JOIN schema_dev.DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_DEVICE,
					B.ID_DATASET,
					B.ID_RESOURCE,
					B.ID_PARAMETER_TYPE,
					(SELECT X.DS_PARAMETER_TYPE FROM schema_dev.PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_TYPE,
					(SELECT X.DS_PARAMETER_ATTRIBUTE FROM schema_dev.PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_ATTRIBUTE,
					B.NR_ITERATIONS,
					B.VL_GRID_ROW_DIMENSION,
					B.VL_GRID_COLUMN_DIMENSION,
					B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION AS VL_GRID_ROW_X_COLUMN_DIMENSION,
					ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) AS VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
					B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION || ' (' || ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
					B.VL_BLOCK_ROW_DIMENSION,
					B.VL_BLOCK_COLUMN_DIMENSION,
					B.VL_BLOCK_ROW_DIMENSION || ' x ' || B.VL_BLOCK_COLUMN_DIMENSION AS VL_BLOCK_ROW_X_COLUMN_DIMENSION,
					B.VL_BLOCK_MEMORY_SIZE,
					B.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
					B.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
					ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) AS VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
					ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ' (' || ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
					C.DS_RESOURCE,
					C.NR_NODES,
					C.NR_COMPUTING_UNITS_CPU,
					C.NR_COMPUTING_UNITS_GPU,
					C.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
					C.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
					(C.NR_NODES-1) || ' (' || (C.NR_NODES-1)*C.NR_COMPUTING_UNITS_CPU || ';' || (C.NR_NODES-1)*4 || ')' AS NR_CONCAT_NODES_TOTAL_COMPUTING_UNITS_CPU_GPU,
					D.DS_DATASET,
					D.VL_DATASET_MEMORY_SIZE,
					D.DS_DATA_TYPE,
					D.VL_DATA_TYPE_MEMORY_SIZE,
					D.VL_DATASET_DIMENSION,
					D.VL_DATASET_ROW_DIMENSION,
					D.VL_DATASET_COLUMN_DIMENSION,
					D.VL_DATASET_ROW_DIMENSION || ' x ' || D.VL_DATASET_COLUMN_DIMENSION AS VL_DATASET_ROW_X_COLUMN_DIMENSION,
					D.NR_RANDOM_STATE
				FROM schema_dev.EXPERIMENT_RAW A
				INNER JOIN schema_dev.PARAMETER B ON (A.ID_PARAMETER = B.ID_PARAMETER)
				INNER JOIN schema_dev.RESOURCE C ON (B.ID_RESOURCE = C.ID_RESOURCE)
				INNER JOIN schema_dev.DATASET D ON (B.ID_DATASET = D.ID_DATASET)
				WHERE
				(SELECT DISTINCT Z.DS_DEVICE FROM schema_dev.FUNCTION W INNER JOIN schema_dev.DEVICE Z ON (W.ID_DEVICE = Z.ID_DEVICE) WHERE W.ID_FUNCTION = B.ID_FUNCTION) = 'CPU'
			) X
			GROUP BY
			X.ID_PARAMETER,
			X.CD_PARAMETER,
			X.CD_CONFIGURATION,
			X.ID_ALGORITHM,
			X.DS_ALGORITHM,
			X.ID_FUNCTION,
			X.DS_FUNCTION,
			X.ID_DEVICE,
			X.DS_DEVICE,
			X.ID_DATASET,
			X.ID_RESOURCE,
			X.ID_PARAMETER_TYPE,
			X.DS_PARAMETER_TYPE,
			X.DS_PARAMETER_ATTRIBUTE,
			X.NR_ITERATIONS,
			X.VL_GRID_ROW_DIMENSION,
			X.VL_GRID_COLUMN_DIMENSION,
			X.VL_GRID_ROW_X_COLUMN_DIMENSION,
			X.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
			X.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
			X.VL_BLOCK_ROW_DIMENSION,
			X.VL_BLOCK_COLUMN_DIMENSION,
			X.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
			X.VL_BLOCK_MEMORY_SIZE,
			X.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
			X.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
			X.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
			X.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
			X.DS_RESOURCE,
			X.NR_NODES,
			X.NR_COMPUTING_UNITS_CPU,
			X.NR_COMPUTING_UNITS_GPU,
			X.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
			X.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
			X.NR_CONCAT_NODES_TOTAL_COMPUTING_UNITS_CPU_GPU,
			X.DS_DATASET,
			X.VL_DATASET_MEMORY_SIZE,
			X.DS_DATA_TYPE,
			X.VL_DATA_TYPE_MEMORY_SIZE,
			X.VL_DATASET_DIMENSION,
			X.VL_DATASET_ROW_DIMENSION,
			X.VL_DATASET_COLUMN_DIMENSION,
			X.VL_DATASET_ROW_X_COLUMN_DIMENSION,
			X.NR_RANDOM_STATE
		) Y

	),
T_GPU AS (
	SELECT
		Y.VL_TOTAL_EXECUTION_TIME,
		Y.VL_INTER_TASK_EXECUTION_TIME,
		Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
		Y.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
		Y.VL_COMMUNICATION_TIME,
		(Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC + Y.VL_COMMUNICATION_TIME) AS VL_INTRA_TASK_EXECUTION_TIME_FREE_ADDITIONAL,
		(Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC+Y.VL_ADDITIONAL_TIME) AS VL_INTRA_TASK_EXECUTION_TIME_FREE_COMMUNICATION,
		Y.ID_PARAMETER,
		Y.CD_PARAMETER,
		Y.CD_CONFIGURATION,
		Y.ID_ALGORITHM,
		Y.DS_ALGORITHM,
		Y.ID_FUNCTION,
		Y.DS_FUNCTION,
		Y.ID_DEVICE,
		Y.DS_DEVICE,
		Y.ID_DATASET,
		Y.ID_RESOURCE,
		Y.ID_PARAMETER_TYPE,
		Y.DS_PARAMETER_TYPE,
		Y.DS_PARAMETER_ATTRIBUTE,
		Y.NR_ITERATIONS,
		Y.VL_GRID_ROW_DIMENSION,
		Y.VL_GRID_COLUMN_DIMENSION,
		Y.VL_BLOCK_ROW_DIMENSION,
		Y.VL_BLOCK_COLUMN_DIMENSION,
		Y.VL_BLOCK_MEMORY_SIZE,
		Y.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
		Y.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
		Y.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		Y.DS_RESOURCE,
		Y.NR_NODES,
		Y.NR_COMPUTING_UNITS_CPU,
		Y.NR_COMPUTING_UNITS_GPU,
		Y.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
		Y.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
		Y.NR_CONCAT_NODES_TOTAL_COMPUTING_UNITS_CPU_GPU,
		Y.DS_DATASET,
		Y.VL_DATASET_MEMORY_SIZE,
		Y.DS_DATA_TYPE,
		Y.VL_DATA_TYPE_MEMORY_SIZE,
		Y.VL_DATASET_DIMENSION,
		Y.VL_DATASET_ROW_DIMENSION,
		Y.VL_DATASET_COLUMN_DIMENSION,
		Y.NR_RANDOM_STATE
		FROM
		(
			SELECT
			AVG(X.VL_TOTAL_EXECUTION_TIME) AS VL_TOTAL_EXECUTION_TIME,
			AVG(X.VL_INTER_TASK_EXECUTION_TIME) AS VL_INTER_TASK_EXECUTION_TIME,
			AVG(X.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
			AVG(X.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
			AVG(X.VL_COMMUNICATION_TIME_1) AS VL_COMMUNICATION_TIME_1,
			AVG(X.VL_COMMUNICATION_TIME_2) AS VL_COMMUNICATION_TIME_2,
			AVG(X.VL_COMMUNICATION_TIME) AS VL_COMMUNICATION_TIME,
			AVG(X.VL_ADDITIONAL_TIME_1) AS VL_ADDITIONAL_TIME_1,
			AVG(X.VL_ADDITIONAL_TIME_2) AS VL_ADDITIONAL_TIME_2,
			AVG(X.VL_ADDITIONAL_TIME) AS VL_ADDITIONAL_TIME,
			X.ID_PARAMETER,
			X.CD_PARAMETER,
			X.CD_CONFIGURATION,
			X.ID_ALGORITHM,
			X.DS_ALGORITHM,
			X.ID_FUNCTION,
			X.DS_FUNCTION,
			X.ID_DEVICE,
			X.DS_DEVICE,
			X.ID_DATASET,
			X.ID_RESOURCE,
			X.ID_PARAMETER_TYPE,
			X.DS_PARAMETER_TYPE,
			X.DS_PARAMETER_ATTRIBUTE,
			X.NR_ITERATIONS,
			X.VL_GRID_ROW_DIMENSION,
			X.VL_GRID_COLUMN_DIMENSION,
			X.VL_GRID_ROW_X_COLUMN_DIMENSION,
			X.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
			X.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
			X.VL_BLOCK_ROW_DIMENSION,
			X.VL_BLOCK_COLUMN_DIMENSION,
			X.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
			X.VL_BLOCK_MEMORY_SIZE,
			X.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
			X.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
			X.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
			X.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
			X.DS_RESOURCE,
			X.NR_NODES,
			X.NR_COMPUTING_UNITS_CPU,
			X.NR_COMPUTING_UNITS_GPU,
			X.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
			X.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
			X.NR_CONCAT_NODES_TOTAL_COMPUTING_UNITS_CPU_GPU,
			X.DS_DATASET,
			X.VL_DATASET_MEMORY_SIZE,
			X.DS_DATA_TYPE,
			X.VL_DATA_TYPE_MEMORY_SIZE,
			X.VL_DATASET_DIMENSION,
			X.VL_DATASET_ROW_DIMENSION,
			X.VL_DATASET_COLUMN_DIMENSION,
			X.VL_DATASET_ROW_X_COLUMN_DIMENSION,
			X.NR_RANDOM_STATE
			FROM
			(
				SELECT
					A.ID_EXPERIMENT,
					A.VL_TOTAL_EXECUTION_TIME,
					A.VL_INTER_TASK_EXECUTION_TIME,
					A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
					A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
					A.VL_COMMUNICATION_TIME_1,
					A.VL_COMMUNICATION_TIME_2,
					A.VL_COMMUNICATION_TIME_1 + A.VL_COMMUNICATION_TIME_2 AS VL_COMMUNICATION_TIME,
					A.VL_ADDITIONAL_TIME_1,
					A.VL_ADDITIONAL_TIME_2,
					A.VL_ADDITIONAL_TIME_1 + A.VL_ADDITIONAL_TIME_2 AS VL_ADDITIONAL_TIME,
					A.DT_PROCESSING,
					B.ID_PARAMETER,
					B.CD_PARAMETER,
					B.CD_CONFIGURATION,
					B.ID_ALGORITHM,
					(SELECT DISTINCT X.DS_ALGORITHM FROM schema_dev.ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) AS DS_ALGORITHM,
					B.ID_FUNCTION,
					(SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_FUNCTION,
					(SELECT DISTINCT Y.ID_DEVICE FROM FUNCTION X INNER JOIN schema_dev.DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS ID_DEVICE,
					(SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN schema_dev.DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_DEVICE,
					B.ID_DATASET,
					B.ID_RESOURCE,
					B.ID_PARAMETER_TYPE,
					(SELECT X.DS_PARAMETER_TYPE FROM schema_dev.PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_TYPE,
					(SELECT X.DS_PARAMETER_ATTRIBUTE FROM schema_dev.PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_ATTRIBUTE,
					B.NR_ITERATIONS,
					B.VL_GRID_ROW_DIMENSION,
					B.VL_GRID_COLUMN_DIMENSION,
					B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION AS VL_GRID_ROW_X_COLUMN_DIMENSION,
					ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) AS VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
					B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION || ' (' || ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
					B.VL_BLOCK_ROW_DIMENSION,
					B.VL_BLOCK_COLUMN_DIMENSION,
					B.VL_BLOCK_ROW_DIMENSION || ' x ' || B.VL_BLOCK_COLUMN_DIMENSION AS VL_BLOCK_ROW_X_COLUMN_DIMENSION,
					B.VL_BLOCK_MEMORY_SIZE,
					B.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
					B.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
					ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) AS VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
					ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ' (' || ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
					C.DS_RESOURCE,
					C.NR_NODES,
					C.NR_COMPUTING_UNITS_CPU,
					C.NR_COMPUTING_UNITS_GPU,
					C.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
					C.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
					(C.NR_NODES-1) || ' (' || (C.NR_NODES-1)*C.NR_COMPUTING_UNITS_CPU || ';' || (C.NR_NODES-1)*4 || ')' AS NR_CONCAT_NODES_TOTAL_COMPUTING_UNITS_CPU_GPU,
					D.DS_DATASET,
					D.VL_DATASET_MEMORY_SIZE,
					D.DS_DATA_TYPE,
					D.VL_DATA_TYPE_MEMORY_SIZE,
					D.VL_DATASET_DIMENSION,
					D.VL_DATASET_ROW_DIMENSION,
					D.VL_DATASET_COLUMN_DIMENSION,
					D.VL_DATASET_ROW_DIMENSION || ' x ' || D.VL_DATASET_COLUMN_DIMENSION AS VL_DATASET_ROW_X_COLUMN_DIMENSION,
					D.NR_RANDOM_STATE
				FROM schema_dev.EXPERIMENT_RAW A
				INNER JOIN schema_dev.PARAMETER B ON (A.ID_PARAMETER = B.ID_PARAMETER)
				INNER JOIN schema_dev.RESOURCE C ON (B.ID_RESOURCE = C.ID_RESOURCE)
				INNER JOIN schema_dev.DATASET D ON (B.ID_DATASET = D.ID_DATASET)
				WHERE
				(SELECT DISTINCT Z.DS_DEVICE FROM FUNCTION W INNER JOIN schema_dev.DEVICE Z ON (W.ID_DEVICE = Z.ID_DEVICE) WHERE W.ID_FUNCTION = B.ID_FUNCTION) = 'GPU'
				AND A.ID_EXPERIMENT NOT IN (778235,778499,778234,778250,778251,778249,778248,778241,778240,778239) -- GRID ROW DIM 256
				AND A.ID_EXPERIMENT NOT IN (791476,791478,791474,791498,791473,791614,791472,791471,791501,791613) -- GRID ROW DIM 128
				AND A.ID_EXPERIMENT NOT IN (790508,790515,790496,790510,790517,790516,790518,790498,790497,790525) -- GRID ROW DIM 64
				AND A.ID_EXPERIMENT NOT IN (776778,776777,776780,776779,776776,776794,776793,776795,776792,776791) -- GRID ROW DIM 32
				AND A.ID_EXPERIMENT NOT IN (790087,790094,790086,790098,790100,790099,790096,790097,790149,790104) -- GRID ROW DIM 16
			) X
			GROUP BY
			X.ID_PARAMETER,
			X.CD_PARAMETER,
			X.CD_CONFIGURATION,
			X.ID_ALGORITHM,
			X.DS_ALGORITHM,
			X.ID_FUNCTION,
			X.DS_FUNCTION,
			X.ID_DEVICE,
			X.DS_DEVICE,
			X.ID_DATASET,
			X.ID_RESOURCE,
			X.ID_PARAMETER_TYPE,
			X.DS_PARAMETER_TYPE,
			X.DS_PARAMETER_ATTRIBUTE,
			X.NR_ITERATIONS,
			X.VL_GRID_ROW_DIMENSION,
			X.VL_GRID_COLUMN_DIMENSION,
			X.VL_GRID_ROW_X_COLUMN_DIMENSION,
			X.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
			X.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
			X.VL_BLOCK_ROW_DIMENSION,
			X.VL_BLOCK_COLUMN_DIMENSION,
			X.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
			X.VL_BLOCK_MEMORY_SIZE,
			X.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
			X.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
			X.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
			X.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
			X.DS_RESOURCE,
			X.NR_NODES,
			X.NR_COMPUTING_UNITS_CPU,
			X.NR_COMPUTING_UNITS_GPU,
			X.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
			X.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
			X.NR_CONCAT_NODES_TOTAL_COMPUTING_UNITS_CPU_GPU,
			X.DS_DATASET,
			X.VL_DATASET_MEMORY_SIZE,
			X.DS_DATA_TYPE,
			X.VL_DATA_TYPE_MEMORY_SIZE,
			X.VL_DATASET_DIMENSION,
			X.VL_DATASET_ROW_DIMENSION,
			X.VL_DATASET_COLUMN_DIMENSION,
			X.VL_DATASET_ROW_X_COLUMN_DIMENSION,
			X.NR_RANDOM_STATE
		) Y
)
SELECT
T_CPU.DS_ALGORITHM,
T_CPU.DS_DATASET,
CASE
	WHEN T_CPU.DS_ALGORITHM = 'KMEANS'
		THEN
			CASE
				WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.3 THEN 0.4 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*5  || ')'
				WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.7 THEN 0.8 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*5  || ')'
				WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 1.5 THEN 1.6 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*5  || ')'
				WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 3.0 THEN 3.1 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*5  || ')'
				WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 6.2 THEN 6.3 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*5  || ')'
				ELSE ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*5  || ')'
			END
	WHEN T_CPU.DS_ALGORITHM = 'MATMUL_DISLIB'
		THEN
			CASE
				WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.3 THEN 0.4 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION + T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*(T_CPU.VL_GRID_ROW_DIMENSION-1)  || ')'
				WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.7 THEN 0.8 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION + T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*(T_CPU.VL_GRID_ROW_DIMENSION-1)  || ')'
				WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 1.5 THEN 1.6 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION + T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*(T_CPU.VL_GRID_ROW_DIMENSION-1)  || ')'
				WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 3.0 THEN 3.1 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION + T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*(T_CPU.VL_GRID_ROW_DIMENSION-1)  || ')'
				WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 6.2 THEN 6.3 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION + T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*(T_CPU.VL_GRID_ROW_DIMENSION-1)  || ')'
				ELSE ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*5  || ')'
			END
	ELSE
		'999999999999'
END AS CONCAT_BLOCK_PERCENT_DATASET_NR_TASKS,
CASE
WHEN (T_CPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC/T_GPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC) > 1.00 THEN (T_CPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC/T_GPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC)
ELSE -(T_GPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC/T_CPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC)
END AS SPEEDUP_PARALLEL_FRACTION,--SPEEDUP_GPU_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
CASE
WHEN (T_CPU.VL_INTRA_TASK_EXECUTION_TIME_FREE_COMMUNICATION/T_GPU.VL_INTRA_TASK_EXECUTION_TIME_FREE_COMMUNICATION) > 1.00 THEN (T_CPU.VL_INTRA_TASK_EXECUTION_TIME_FREE_COMMUNICATION/T_GPU.VL_INTRA_TASK_EXECUTION_TIME_FREE_COMMUNICATION)
ELSE -(T_GPU.VL_INTRA_TASK_EXECUTION_TIME_FREE_COMMUNICATION/T_CPU.VL_INTRA_TASK_EXECUTION_TIME_FREE_COMMUNICATION)
END AS SPEEDUP_USER_CODE,--SPEEDUP_GPU_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
CASE
WHEN (T_CPU.VL_INTER_TASK_EXECUTION_TIME/T_GPU.VL_INTER_TASK_EXECUTION_TIME) > 1.00 THEN (T_CPU.VL_INTER_TASK_EXECUTION_TIME/T_GPU.VL_INTER_TASK_EXECUTION_TIME)
ELSE -(T_GPU.VL_INTER_TASK_EXECUTION_TIME/T_CPU.VL_INTER_TASK_EXECUTION_TIME)
END AS SPEEDUP_PARALLEL_TASK--SPEEDUP_GPU_INTER_TASK_EXECUTION_TIME
FROM T_CPU INNER JOIN T_GPU ON (T_CPU.CD_PARAMETER = T_GPU.CD_PARAMETER)
WHERE
T_CPU.VL_GRID_ROW_DIMENSION = T_GPU.VL_GRID_ROW_DIMENSION
AND T_CPU.VL_GRID_COLUMN_DIMENSION = T_GPU.VL_GRID_COLUMN_DIMENSION
AND T_CPU.VL_BLOCK_ROW_DIMENSION = T_GPU.VL_BLOCK_ROW_DIMENSION
AND T_CPU.VL_BLOCK_COLUMN_DIMENSION = T_GPU.VL_BLOCK_COLUMN_DIMENSION
AND T_CPU.ds_dataset = 'S_100GB_1'
AND T_CPU.ds_parameter_type = 'VAR_GRID_ROW_5'
ORDER BY
T_CPU.DS_DATASET,
T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET


-- EXTRA FIGURE 1 - LARGER DATASETS - PART 2 - EXECUTION TIMES KMEANS
SELECT
DS_ALGORITHM,
DS_DEVICE,
CASE
	WHEN DS_ALGORITHM = 'KMEANS'
		THEN
			CASE
				WHEN ROUND(VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.3 THEN 0.4 || ' (' || VL_GRID_ROW_DIMENSION*5  || ')'
				WHEN ROUND(VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.7 THEN 0.8 || ' (' || VL_GRID_ROW_DIMENSION*5  || ')'
				WHEN ROUND(VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 1.5 THEN 1.6 || ' (' || VL_GRID_ROW_DIMENSION*5  || ')'
				WHEN ROUND(VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 3.0 THEN 3.1 || ' (' || VL_GRID_ROW_DIMENSION*5  || ')'
				WHEN ROUND(VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 6.2 THEN 6.3 || ' (' || VL_GRID_ROW_DIMENSION*5  || ')'
				ELSE ROUND(VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) || ' (' || VL_GRID_ROW_DIMENSION*5  || ')'
			END
	WHEN DS_ALGORITHM = 'MATMUL_DISLIB'
		THEN
			CASE
				WHEN ROUND(VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.3 THEN 0.4 || ' (' || VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION + VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION*(VL_GRID_ROW_DIMENSION-1)  || ')'
				WHEN ROUND(VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.7 THEN 0.8 || ' (' || VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION + VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION*(VL_GRID_ROW_DIMENSION-1)  || ')'
				WHEN ROUND(VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 1.5 THEN 1.6 || ' (' || VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION + VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION*(VL_GRID_ROW_DIMENSION-1)  || ')'
				WHEN ROUND(VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 3.0 THEN 3.1 || ' (' || VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION + VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION*(VL_GRID_ROW_DIMENSION-1)  || ')'
				WHEN ROUND(VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 6.2 THEN 6.3 || ' (' || VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION + VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION*(VL_GRID_ROW_DIMENSION-1)  || ')'
				ELSE ROUND(VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) || ' (' || VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION + VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION*(VL_GRID_ROW_DIMENSION-1)  || ')'
			END
	ELSE
		'999999999999'
END AS CONCAT_BLOCK_PERCENT_DATASET_NR_TASKS,
VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
VL_BLOCK_ROW_X_COLUMN_DIMENSION,
VL_GRID_ROW_X_COLUMN_DIMENSION,
VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC AS VL_USER_CODE_TIME,
VL_ADDITIONAL_TIME AS VL_SERIAL_FRACTION_TIME,
VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC AS VL_PARALLEL_FRACTION_TIME,
VL_COMMUNICATION_TIME AS VL_CPU_GPU_COMMUNICATION_TIME
FROM
(
	SELECT
		Y.VL_TOTAL_EXECUTION_TIME,
		Y.VL_INTER_TASK_EXECUTION_TIME,
		(Y.VL_INTER_TASK_EXECUTION_TIME - Y.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_INTER_TASK_OVERHEAD_TIME,
		Y.VL_INTER_TASK_EXECUTION_TIME - (Y.VL_INTER_TASK_EXECUTION_TIME - Y.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_INTER_TASK_EXECUTION_TIME_FREE_OVERHEAD,
		Y.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
		Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
		Y.VL_COMMUNICATION_TIME,
		Y.VL_ADDITIONAL_TIME,
		(Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC + Y.VL_COMMUNICATION_TIME) AS VL_INTRA_TASK_EXECUTION_TIME_FREE_ADDITIONAL,
		Y.CD_PARAMETER,
		Y.CD_CONFIGURATION,
		Y.ID_ALGORITHM,
		Y.DS_ALGORITHM,
		Y.ID_DEVICE,
		Y.DS_DEVICE,
		Y.ID_DATASET,
		Y.ID_RESOURCE,
		Y.ID_PARAMETER_TYPE,
		Y.DS_PARAMETER_TYPE,
		Y.DS_PARAMETER_ATTRIBUTE,
		Y.NR_ITERATIONS,
		Y.VL_GRID_ROW_DIMENSION,
		Y.VL_GRID_COLUMN_DIMENSION,
		Y.VL_GRID_ROW_X_COLUMN_DIMENSION,
		Y.VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
		Y.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
		Y.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
		Y.VL_BLOCK_ROW_DIMENSION,
		Y.VL_BLOCK_COLUMN_DIMENSION,
		Y.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
		Y.VL_BLOCK_MEMORY_SIZE,
		Y.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
		Y.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
		Y.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		Y.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		Y.DS_RESOURCE,
		Y.NR_NODES,
		Y.NR_COMPUTING_UNITS_CPU,
		(Y.NR_NODES-1)*Y.NR_COMPUTING_UNITS_CPU AS NR_TOTAL_COMPUTING_UNITS_CPU,
		(Y.NR_NODES-1) || ' (' || (Y.NR_NODES-1)*Y.NR_COMPUTING_UNITS_CPU || ')' AS NR_CONCAT_NODES_TOTAL_COMPUTING_UNITS_CPU,
		Y.NR_COMPUTING_UNITS_GPU,
		Y.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
		Y.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
		Y.DS_DATASET,
		Y.VL_DATASET_MEMORY_SIZE,
		Y.DS_DATA_TYPE,
		Y.VL_DATA_TYPE_MEMORY_SIZE,
		Y.VL_DATASET_DIMENSION,
		Y.VL_DATASET_ROW_DIMENSION,
		Y.VL_DATASET_COLUMN_DIMENSION,
		Y.VL_DATASET_ROW_X_COLUMN_DIMENSION,
		Y.NR_RANDOM_STATE
		FROM
		(
			SELECT
			AVG(X.VL_TOTAL_EXECUTION_TIME) AS VL_TOTAL_EXECUTION_TIME,
			AVG(X.VL_INTER_TASK_EXECUTION_TIME) AS VL_INTER_TASK_EXECUTION_TIME,
			AVG(X.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
			AVG(X.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
			AVG(X.VL_COMMUNICATION_TIME_1) AS VL_COMMUNICATION_TIME_1,
			AVG(X.VL_COMMUNICATION_TIME_2) AS VL_COMMUNICATION_TIME_2,
			AVG(X.VL_COMMUNICATION_TIME) AS VL_COMMUNICATION_TIME,
			AVG(X.VL_ADDITIONAL_TIME_1) AS VL_ADDITIONAL_TIME_1,
			AVG(X.VL_ADDITIONAL_TIME_2) AS VL_ADDITIONAL_TIME_2,
			AVG(X.VL_ADDITIONAL_TIME) AS VL_ADDITIONAL_TIME,
			X.CD_PARAMETER,
			X.CD_CONFIGURATION,
			X.ID_ALGORITHM,
			X.DS_ALGORITHM,
			X.ID_DEVICE,
			X.DS_DEVICE,
			X.ID_DATASET,
			X.ID_RESOURCE,
			X.ID_PARAMETER_TYPE,
			X.DS_PARAMETER_TYPE,
			X.DS_PARAMETER_ATTRIBUTE,
			X.NR_ITERATIONS,
			X.VL_GRID_ROW_DIMENSION,
			X.VL_GRID_COLUMN_DIMENSION,
			X.VL_GRID_ROW_X_COLUMN_DIMENSION,
			X.VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
			X.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
			X.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
			X.VL_BLOCK_ROW_DIMENSION,
			X.VL_BLOCK_COLUMN_DIMENSION,
			X.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
			X.VL_BLOCK_MEMORY_SIZE,
			X.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
			X.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
			X.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
			X.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
			X.DS_RESOURCE,
			X.NR_NODES,
			X.NR_COMPUTING_UNITS_CPU,
			X.NR_COMPUTING_UNITS_GPU,
			X.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
			X.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
			X.DS_DATASET,
			X.VL_DATASET_MEMORY_SIZE,
			X.DS_DATA_TYPE,
			X.VL_DATA_TYPE_MEMORY_SIZE,
			X.VL_DATASET_DIMENSION,
			X.VL_DATASET_ROW_DIMENSION,
			X.VL_DATASET_COLUMN_DIMENSION,
			X.VL_DATASET_ROW_X_COLUMN_DIMENSION,
			X.NR_RANDOM_STATE
			FROM
			(
				SELECT
					A.ID_EXPERIMENT,
					A.VL_TOTAL_EXECUTION_TIME,
					A.VL_INTER_TASK_EXECUTION_TIME,
					A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
					A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
					A.VL_COMMUNICATION_TIME_1,
					A.VL_COMMUNICATION_TIME_2,
					A.VL_COMMUNICATION_TIME_1 + A.VL_COMMUNICATION_TIME_2 AS VL_COMMUNICATION_TIME,
					A.VL_ADDITIONAL_TIME_1,
					A.VL_ADDITIONAL_TIME_2,
					A.VL_ADDITIONAL_TIME_1 + A.VL_ADDITIONAL_TIME_2 AS VL_ADDITIONAL_TIME,
					(A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC + A.VL_ADDITIONAL_TIME_1 + A.VL_ADDITIONAL_TIME_2) AS VL_INTRA_TASK_EXECUTION_TIME_FREE_ADDITIONAL,
					A.DT_PROCESSING,
					B.CD_PARAMETER,
					B.CD_CONFIGURATION,
					B.ID_ALGORITHM,
					(SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) AS DS_ALGORITHM,
					B.ID_FUNCTION,
					(SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_FUNCTION,
					(SELECT DISTINCT Y.ID_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS ID_DEVICE,
					(SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_DEVICE,
					B.ID_DATASET,
					B.ID_RESOURCE,
					B.ID_PARAMETER_TYPE,
					(SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_TYPE,
					(SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_ATTRIBUTE,
					B.NR_ITERATIONS,
					B.VL_GRID_ROW_DIMENSION,
					B.VL_GRID_COLUMN_DIMENSION,
					B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION AS VL_GRID_ROW_X_COLUMN_DIMENSION,
					B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION || ' (' || ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,0) || ')' AS VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
					ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) AS VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
					B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION || ' (' || ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
					B.VL_BLOCK_ROW_DIMENSION,
					B.VL_BLOCK_COLUMN_DIMENSION,
					B.VL_BLOCK_ROW_DIMENSION || ' x ' || B.VL_BLOCK_COLUMN_DIMENSION AS VL_BLOCK_ROW_X_COLUMN_DIMENSION,
					B.VL_BLOCK_MEMORY_SIZE,
					B.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
					B.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
					ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) AS VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
					ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ' (' || ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
					C.DS_RESOURCE,
					C.NR_NODES,
					C.NR_COMPUTING_UNITS_CPU,
					C.NR_COMPUTING_UNITS_GPU,
					C.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
					C.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
					D.DS_DATASET,
					D.VL_DATASET_MEMORY_SIZE,
					D.DS_DATA_TYPE,
					D.VL_DATA_TYPE_MEMORY_SIZE,
					D.VL_DATASET_DIMENSION,
					D.VL_DATASET_ROW_DIMENSION,
					D.VL_DATASET_COLUMN_DIMENSION,
					D.VL_DATASET_ROW_DIMENSION || ' x ' || D.VL_DATASET_COLUMN_DIMENSION AS VL_DATASET_ROW_X_COLUMN_DIMENSION,
					D.NR_RANDOM_STATE
				FROM EXPERIMENT_RAW A
				INNER JOIN PARAMETER B ON (A.ID_PARAMETER = B.ID_PARAMETER)
				INNER JOIN RESOURCE C ON (B.ID_RESOURCE = C.ID_RESOURCE)
				INNER JOIN DATASET D ON (B.ID_DATASET = D.ID_DATASET)
				WHERE
				A.ID_EXPERIMENT NOT IN (778235,778499,778234,778250,778251,778249,778248,778241,778240,778239) -- GRID ROW DIM 256
				AND A.ID_EXPERIMENT NOT IN (791476,791478,791474,791498,791473,791614,791472,791471,791501,791613) -- GRID ROW DIM 128
				AND A.ID_EXPERIMENT NOT IN (790508,790515,790496,790510,790517,790516,790518,790498,790497,790525) -- GRID ROW DIM 64
				AND A.ID_EXPERIMENT NOT IN (776778,776777,776780,776779,776776,776794,776793,776795,776792,776791) -- GRID ROW DIM 32
				AND A.ID_EXPERIMENT NOT IN (790087,790094,790086,790098,790100,790099,790096,790097,790149,790104) -- GRID ROW DIM 16
			) X
			GROUP BY
			X.CD_PARAMETER,
			X.CD_CONFIGURATION,
			X.ID_ALGORITHM,
			X.DS_ALGORITHM,
			X.ID_DEVICE,
			X.DS_DEVICE,
			X.ID_DATASET,
			X.ID_RESOURCE,
			X.ID_PARAMETER_TYPE,
			X.DS_PARAMETER_TYPE,
			X.DS_PARAMETER_ATTRIBUTE,
			X.NR_ITERATIONS,
			X.VL_GRID_ROW_DIMENSION,
			X.VL_GRID_COLUMN_DIMENSION,
			X.VL_GRID_ROW_X_COLUMN_DIMENSION,
			X.VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
			X.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
			X.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
			X.VL_BLOCK_ROW_DIMENSION,
			X.VL_BLOCK_COLUMN_DIMENSION,
			X.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
			X.VL_BLOCK_MEMORY_SIZE,
			X.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
			X.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
			X.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
			X.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
			X.DS_RESOURCE,
			X.NR_NODES,
			X.NR_COMPUTING_UNITS_CPU,
			X.NR_COMPUTING_UNITS_GPU,
			X.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
			X.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
			X.DS_DATASET,
			X.VL_DATASET_MEMORY_SIZE,
			X.DS_DATA_TYPE,
			X.VL_DATA_TYPE_MEMORY_SIZE,
			X.VL_DATASET_DIMENSION,
			X.VL_DATASET_ROW_DIMENSION,
			X.VL_DATASET_COLUMN_DIMENSION,
			X.VL_DATASET_ROW_X_COLUMN_DIMENSION,
			X.NR_RANDOM_STATE
		) Y
) ZZ
WHERE
ZZ.nr_iterations = 5
AND ZZ.ds_algorithm='KMEANS'
AND ZZ.ds_dataset = 'S_100GB_1'
AND ZZ.ds_parameter_type = 'VAR_GRID_ROW_5'
AND ZZ.ds_device = 'GPU'
ORDER BY
DS_DEVICE,
VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
DS_ALGORITHM DESC




WITH T_CPU AS (
SELECT
	Y.VL_TOTAL_EXECUTION_TIME,
	Y.VL_INTER_TASK_EXECUTION_TIME,
	Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
	Y.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
	Y.VL_COMMUNICATION_TIME,
	(Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC + Y.VL_COMMUNICATION_TIME) AS VL_INTRA_TASK_EXECUTION_TIME_FREE_ADDITIONAL,
	Y.ID_PARAMETER,
	Y.CD_PARAMETER,
	Y.CD_CONFIGURATION,
	Y.ID_ALGORITHM,
	Y.DS_ALGORITHM,
	Y.ID_FUNCTION,
	Y.DS_FUNCTION,
	Y.ID_DEVICE,
	Y.DS_DEVICE,
	Y.ID_DATASET,
	Y.ID_RESOURCE,
	Y.ID_PARAMETER_TYPE,
	Y.DS_PARAMETER_TYPE,
	Y.DS_PARAMETER_ATTRIBUTE,
	Y.NR_ITERATIONS,
	Y.VL_GRID_ROW_DIMENSION,
	Y.VL_GRID_COLUMN_DIMENSION,
	Y.VL_BLOCK_ROW_DIMENSION,
	Y.VL_BLOCK_COLUMN_DIMENSION,
	Y.VL_BLOCK_MEMORY_SIZE,
	Y.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
	Y.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
	Y.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
	Y.DS_RESOURCE,
	Y.NR_NODES,
	Y.NR_COMPUTING_UNITS_CPU,
	Y.NR_COMPUTING_UNITS_GPU,
	Y.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
	Y.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
	Y.NR_CONCAT_NODES_TOTAL_COMPUTING_UNITS_CPU_GPU,
	Y.DS_DATASET,
	Y.VL_DATASET_MEMORY_SIZE,
	Y.DS_DATA_TYPE,
	Y.VL_DATA_TYPE_MEMORY_SIZE,
	Y.VL_DATASET_DIMENSION,
	Y.VL_DATASET_ROW_DIMENSION,
	Y.VL_DATASET_COLUMN_DIMENSION,
	Y.NR_RANDOM_STATE
	FROM
	(
		SELECT
		AVG(X.VL_TOTAL_EXECUTION_TIME) AS VL_TOTAL_EXECUTION_TIME,
		AVG(X.VL_INTER_TASK_EXECUTION_TIME) AS VL_INTER_TASK_EXECUTION_TIME,
		AVG(X.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
		AVG(X.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
		AVG(X.VL_COMMUNICATION_TIME_1) AS VL_COMMUNICATION_TIME_1,
		AVG(X.VL_COMMUNICATION_TIME_2) AS VL_COMMUNICATION_TIME_2,
		AVG(X.VL_COMMUNICATION_TIME) AS VL_COMMUNICATION_TIME,
		AVG(X.VL_ADDITIONAL_TIME_1) AS VL_ADDITIONAL_TIME_1,
		AVG(X.VL_ADDITIONAL_TIME_2) AS VL_ADDITIONAL_TIME_2,
		AVG(X.VL_ADDITIONAL_TIME) AS VL_ADDITIONAL_TIME,
		X.ID_PARAMETER,
		X.CD_PARAMETER,
		X.CD_CONFIGURATION,
		X.ID_ALGORITHM,
		X.DS_ALGORITHM,
		X.ID_FUNCTION,
		X.DS_FUNCTION,
		X.ID_DEVICE,
		X.DS_DEVICE,
		X.ID_DATASET,
		X.ID_RESOURCE,
		X.ID_PARAMETER_TYPE,
		X.DS_PARAMETER_TYPE,
		X.DS_PARAMETER_ATTRIBUTE,
		X.NR_ITERATIONS,
		X.VL_GRID_ROW_DIMENSION,
		X.VL_GRID_COLUMN_DIMENSION,
		X.VL_GRID_ROW_X_COLUMN_DIMENSION,
		X.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
		X.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
		X.VL_BLOCK_ROW_DIMENSION,
		X.VL_BLOCK_COLUMN_DIMENSION,
		X.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
		X.VL_BLOCK_MEMORY_SIZE,
		X.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
		X.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
		X.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		X.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		X.DS_RESOURCE,
		X.NR_NODES,
		X.NR_COMPUTING_UNITS_CPU,
		X.NR_COMPUTING_UNITS_GPU,
		X.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
		X.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
		X.NR_CONCAT_NODES_TOTAL_COMPUTING_UNITS_CPU_GPU,
		X.DS_DATASET,
		X.VL_DATASET_MEMORY_SIZE,
		X.DS_DATA_TYPE,
		X.VL_DATA_TYPE_MEMORY_SIZE,
		X.VL_DATASET_DIMENSION,
		X.VL_DATASET_ROW_DIMENSION,
		X.VL_DATASET_COLUMN_DIMENSION,
		X.VL_DATASET_ROW_X_COLUMN_DIMENSION,
		X.NR_RANDOM_STATE
		FROM
		(
			SELECT
				A.ID_EXPERIMENT,
				A.VL_TOTAL_EXECUTION_TIME,
				A.VL_INTER_TASK_EXECUTION_TIME,
				A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
				A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
				A.VL_COMMUNICATION_TIME_1,
				A.VL_COMMUNICATION_TIME_2,
				A.VL_COMMUNICATION_TIME_1 + A.VL_COMMUNICATION_TIME_2 AS VL_COMMUNICATION_TIME,
				A.VL_ADDITIONAL_TIME_1,
				A.VL_ADDITIONAL_TIME_2,
				A.VL_ADDITIONAL_TIME_1 + A.VL_ADDITIONAL_TIME_2 AS VL_ADDITIONAL_TIME,
				A.DT_PROCESSING,
				B.ID_PARAMETER,
				B.CD_PARAMETER,
				B.CD_CONFIGURATION,
				B.ID_ALGORITHM,
				(SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) AS DS_ALGORITHM,
				B.ID_FUNCTION,
				(SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_FUNCTION,
				(SELECT DISTINCT Y.ID_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS ID_DEVICE,
				(SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_DEVICE,
				B.ID_DATASET,
				B.ID_RESOURCE,
				B.ID_PARAMETER_TYPE,
				(SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_TYPE,
				(SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_ATTRIBUTE,
				B.NR_ITERATIONS,
				B.VL_GRID_ROW_DIMENSION,
				B.VL_GRID_COLUMN_DIMENSION,
				B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION AS VL_GRID_ROW_X_COLUMN_DIMENSION,
				ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) AS VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
				B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION || ' (' || ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
				B.VL_BLOCK_ROW_DIMENSION,
				B.VL_BLOCK_COLUMN_DIMENSION,
				B.VL_BLOCK_ROW_DIMENSION || ' x ' || B.VL_BLOCK_COLUMN_DIMENSION AS VL_BLOCK_ROW_X_COLUMN_DIMENSION,
				B.VL_BLOCK_MEMORY_SIZE,
				B.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
				B.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
				ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) AS VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
				ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ' (' || ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
				C.DS_RESOURCE,
				C.NR_NODES,
				C.NR_COMPUTING_UNITS_CPU,
				C.NR_COMPUTING_UNITS_GPU,
				C.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
				C.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
				(C.NR_NODES-1) || ' (' || (C.NR_NODES-1)*C.NR_COMPUTING_UNITS_CPU || ';' || (C.NR_NODES-1)*4 || ')' AS NR_CONCAT_NODES_TOTAL_COMPUTING_UNITS_CPU_GPU,
				D.DS_DATASET,
				D.VL_DATASET_MEMORY_SIZE,
				D.DS_DATA_TYPE,
				D.VL_DATA_TYPE_MEMORY_SIZE,
				D.VL_DATASET_DIMENSION,
				D.VL_DATASET_ROW_DIMENSION,
				D.VL_DATASET_COLUMN_DIMENSION,
				D.VL_DATASET_ROW_DIMENSION || ' x ' || D.VL_DATASET_COLUMN_DIMENSION AS VL_DATASET_ROW_X_COLUMN_DIMENSION,
				D.NR_RANDOM_STATE
			FROM EXPERIMENT_RAW A
			INNER JOIN PARAMETER B ON (A.ID_PARAMETER = B.ID_PARAMETER)
			INNER JOIN RESOURCE C ON (B.ID_RESOURCE = C.ID_RESOURCE)
			INNER JOIN DATASET D ON (B.ID_DATASET = D.ID_DATASET)
			WHERE
			(SELECT DISTINCT Z.DS_DEVICE FROM FUNCTION W INNER JOIN DEVICE Z ON (W.ID_DEVICE = Z.ID_DEVICE) WHERE W.ID_FUNCTION = B.ID_FUNCTION) = 'CPU'
		) X
		WHERE
		X.DS_FUNCTION = 'MATMUL_FUNC'
		GROUP BY
		X.ID_PARAMETER,
		X.CD_PARAMETER,
		X.CD_CONFIGURATION,
		X.ID_ALGORITHM,
		X.DS_ALGORITHM,
		X.ID_FUNCTION,
		X.DS_FUNCTION,
		X.ID_DEVICE,
		X.DS_DEVICE,
		X.ID_DATASET,
		X.ID_RESOURCE,
		X.ID_PARAMETER_TYPE,
		X.DS_PARAMETER_TYPE,
		X.DS_PARAMETER_ATTRIBUTE,
		X.NR_ITERATIONS,
		X.VL_GRID_ROW_DIMENSION,
		X.VL_GRID_COLUMN_DIMENSION,
		X.VL_GRID_ROW_X_COLUMN_DIMENSION,
		X.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
		X.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
		X.VL_BLOCK_ROW_DIMENSION,
		X.VL_BLOCK_COLUMN_DIMENSION,
		X.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
		X.VL_BLOCK_MEMORY_SIZE,
		X.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
		X.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
		X.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		X.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		X.DS_RESOURCE,
		X.NR_NODES,
		X.NR_COMPUTING_UNITS_CPU,
		X.NR_COMPUTING_UNITS_GPU,
		X.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
		X.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
		X.NR_CONCAT_NODES_TOTAL_COMPUTING_UNITS_CPU_GPU,
		X.DS_DATASET,
		X.VL_DATASET_MEMORY_SIZE,
		X.DS_DATA_TYPE,
		X.VL_DATA_TYPE_MEMORY_SIZE,
		X.VL_DATASET_DIMENSION,
		X.VL_DATASET_ROW_DIMENSION,
		X.VL_DATASET_COLUMN_DIMENSION,
		X.VL_DATASET_ROW_X_COLUMN_DIMENSION,
		X.NR_RANDOM_STATE
	) Y

),
T_GPU AS (                         
SELECT
	Y.VL_TOTAL_EXECUTION_TIME,
	Y.VL_INTER_TASK_EXECUTION_TIME,
	Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
	Y.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
	Y.VL_COMMUNICATION_TIME,
	(Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC + Y.VL_COMMUNICATION_TIME) AS VL_INTRA_TASK_EXECUTION_TIME_FREE_ADDITIONAL,
	Y.ID_PARAMETER,
	Y.CD_PARAMETER,
	Y.CD_CONFIGURATION,
	Y.ID_ALGORITHM,
	Y.DS_ALGORITHM,
	Y.ID_FUNCTION,
	Y.DS_FUNCTION,
	Y.ID_DEVICE,
	Y.DS_DEVICE,
	Y.ID_DATASET,
	Y.ID_RESOURCE,
	Y.ID_PARAMETER_TYPE,
	Y.DS_PARAMETER_TYPE,
	Y.DS_PARAMETER_ATTRIBUTE,
	Y.NR_ITERATIONS,
	Y.VL_GRID_ROW_DIMENSION,
	Y.VL_GRID_COLUMN_DIMENSION,
	Y.VL_BLOCK_ROW_DIMENSION,
	Y.VL_BLOCK_COLUMN_DIMENSION,
	Y.VL_BLOCK_MEMORY_SIZE,
	Y.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
	Y.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
	Y.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
	Y.DS_RESOURCE,
	Y.NR_NODES,
	Y.NR_COMPUTING_UNITS_CPU,
	Y.NR_COMPUTING_UNITS_GPU,
	Y.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
	Y.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
	Y.NR_CONCAT_NODES_TOTAL_COMPUTING_UNITS_CPU_GPU,
	Y.DS_DATASET,
	Y.VL_DATASET_MEMORY_SIZE,
	Y.DS_DATA_TYPE,
	Y.VL_DATA_TYPE_MEMORY_SIZE,
	Y.VL_DATASET_DIMENSION,
	Y.VL_DATASET_ROW_DIMENSION,
	Y.VL_DATASET_COLUMN_DIMENSION,
	Y.NR_RANDOM_STATE
	FROM
	(
		SELECT
		AVG(X.VL_TOTAL_EXECUTION_TIME) AS VL_TOTAL_EXECUTION_TIME,
		AVG(X.VL_INTER_TASK_EXECUTION_TIME) AS VL_INTER_TASK_EXECUTION_TIME,
		AVG(X.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
		AVG(X.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
		AVG(X.VL_COMMUNICATION_TIME_1) AS VL_COMMUNICATION_TIME_1,
		AVG(X.VL_COMMUNICATION_TIME_2) AS VL_COMMUNICATION_TIME_2,
		AVG(X.VL_COMMUNICATION_TIME) AS VL_COMMUNICATION_TIME,
		AVG(X.VL_ADDITIONAL_TIME_1) AS VL_ADDITIONAL_TIME_1,
		AVG(X.VL_ADDITIONAL_TIME_2) AS VL_ADDITIONAL_TIME_2,
		AVG(X.VL_ADDITIONAL_TIME) AS VL_ADDITIONAL_TIME,
		X.ID_PARAMETER,
		X.CD_PARAMETER,
		X.CD_CONFIGURATION,
		X.ID_ALGORITHM,
		X.DS_ALGORITHM,
		X.ID_FUNCTION,
		X.DS_FUNCTION,
		X.ID_DEVICE,
		X.DS_DEVICE,
		X.ID_DATASET,
		X.ID_RESOURCE,
		X.ID_PARAMETER_TYPE,
		X.DS_PARAMETER_TYPE,
		X.DS_PARAMETER_ATTRIBUTE,
		X.NR_ITERATIONS,
		X.VL_GRID_ROW_DIMENSION,
		X.VL_GRID_COLUMN_DIMENSION,
		X.VL_GRID_ROW_X_COLUMN_DIMENSION,
		X.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
		X.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
		X.VL_BLOCK_ROW_DIMENSION,
		X.VL_BLOCK_COLUMN_DIMENSION,
		X.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
		X.VL_BLOCK_MEMORY_SIZE,
		X.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
		X.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
		X.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		X.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		X.DS_RESOURCE,
		X.NR_NODES,
		X.NR_COMPUTING_UNITS_CPU,
		X.NR_COMPUTING_UNITS_GPU,
		X.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
		X.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
		X.NR_CONCAT_NODES_TOTAL_COMPUTING_UNITS_CPU_GPU,
		X.DS_DATASET,
		X.VL_DATASET_MEMORY_SIZE,
		X.DS_DATA_TYPE,
		X.VL_DATA_TYPE_MEMORY_SIZE,
		X.VL_DATASET_DIMENSION,
		X.VL_DATASET_ROW_DIMENSION,
		X.VL_DATASET_COLUMN_DIMENSION,
		X.VL_DATASET_ROW_X_COLUMN_DIMENSION,
		X.NR_RANDOM_STATE
		FROM
		(
			SELECT
				A.ID_EXPERIMENT,
				A.VL_TOTAL_EXECUTION_TIME,
				A.VL_INTER_TASK_EXECUTION_TIME,
				A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
				A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
				A.VL_COMMUNICATION_TIME_1,
				A.VL_COMMUNICATION_TIME_2,
				A.VL_COMMUNICATION_TIME_1 + A.VL_COMMUNICATION_TIME_2 AS VL_COMMUNICATION_TIME,
				A.VL_ADDITIONAL_TIME_1,
				A.VL_ADDITIONAL_TIME_2,
				A.VL_ADDITIONAL_TIME_1 + A.VL_ADDITIONAL_TIME_2 AS VL_ADDITIONAL_TIME,
				A.DT_PROCESSING,
				B.ID_PARAMETER,
				B.CD_PARAMETER,
				B.CD_CONFIGURATION,
				B.ID_ALGORITHM,
				(SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) AS DS_ALGORITHM,
				B.ID_FUNCTION,
				(SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_FUNCTION,
				(SELECT DISTINCT Y.ID_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS ID_DEVICE,
				(SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_DEVICE,
				B.ID_DATASET,
				B.ID_RESOURCE,
				B.ID_PARAMETER_TYPE,
				(SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_TYPE,
				(SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_ATTRIBUTE,
				B.NR_ITERATIONS,
				B.VL_GRID_ROW_DIMENSION,
				B.VL_GRID_COLUMN_DIMENSION,
				B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION AS VL_GRID_ROW_X_COLUMN_DIMENSION,
				ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) AS VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
				B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION || ' (' || ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
				B.VL_BLOCK_ROW_DIMENSION,
				B.VL_BLOCK_COLUMN_DIMENSION,
				B.VL_BLOCK_ROW_DIMENSION || ' x ' || B.VL_BLOCK_COLUMN_DIMENSION AS VL_BLOCK_ROW_X_COLUMN_DIMENSION,
				B.VL_BLOCK_MEMORY_SIZE,
				B.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
				B.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
				ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) AS VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
				ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ' (' || ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
				C.DS_RESOURCE,
				C.NR_NODES,
				C.NR_COMPUTING_UNITS_CPU,
				C.NR_COMPUTING_UNITS_GPU,
				C.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
				C.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
				(C.NR_NODES-1) || ' (' || (C.NR_NODES-1)*C.NR_COMPUTING_UNITS_CPU || ';' || (C.NR_NODES-1)*4 || ')' AS NR_CONCAT_NODES_TOTAL_COMPUTING_UNITS_CPU_GPU,
				D.DS_DATASET,
				D.VL_DATASET_MEMORY_SIZE,
				D.DS_DATA_TYPE,
				D.VL_DATA_TYPE_MEMORY_SIZE,
				D.VL_DATASET_DIMENSION,
				D.VL_DATASET_ROW_DIMENSION,
				D.VL_DATASET_COLUMN_DIMENSION,
				D.VL_DATASET_ROW_DIMENSION || ' x ' || D.VL_DATASET_COLUMN_DIMENSION AS VL_DATASET_ROW_X_COLUMN_DIMENSION,
				D.NR_RANDOM_STATE
			FROM EXPERIMENT_RAW A
			INNER JOIN PARAMETER B ON (A.ID_PARAMETER = B.ID_PARAMETER)
			INNER JOIN RESOURCE C ON (B.ID_RESOURCE = C.ID_RESOURCE)
			INNER JOIN DATASET D ON (B.ID_DATASET = D.ID_DATASET)
			WHERE
			(SELECT DISTINCT Z.DS_DEVICE FROM FUNCTION W INNER JOIN DEVICE Z ON (W.ID_DEVICE = Z.ID_DEVICE) WHERE W.ID_FUNCTION = B.ID_FUNCTION) = 'GPU'
			AND A.ID_EXPERIMENT NOT IN (370685,370675,370662,370681,370667,370670,370676,370652,370679,370669) -- GRID ROW DIM 16
			AND A.ID_EXPERIMENT NOT IN (380224,380190,380234,380233,380206,380248,380156,380152,380151,380158) -- GRID ROW DIM 8
			AND A.ID_EXPERIMENT NOT IN (362026,362018,362024,362037,362036,362028,362032,362029,362023,362052) -- GRID ROW DIM 4
		) X
		WHERE
		X.DS_FUNCTION = 'MATMUL_FUNC'
		GROUP BY
		X.ID_PARAMETER,
		X.CD_PARAMETER,
		X.CD_CONFIGURATION,
		X.ID_ALGORITHM,
		X.DS_ALGORITHM,
		X.ID_FUNCTION,
		X.DS_FUNCTION,
		X.ID_DEVICE,
		X.DS_DEVICE,
		X.ID_DATASET,
		X.ID_RESOURCE,
		X.ID_PARAMETER_TYPE,
		X.DS_PARAMETER_TYPE,
		X.DS_PARAMETER_ATTRIBUTE,
		X.NR_ITERATIONS,
		X.VL_GRID_ROW_DIMENSION,
		X.VL_GRID_COLUMN_DIMENSION,
		X.VL_GRID_ROW_X_COLUMN_DIMENSION,
		X.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
		X.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
		X.VL_BLOCK_ROW_DIMENSION,
		X.VL_BLOCK_COLUMN_DIMENSION,
		X.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
		X.VL_BLOCK_MEMORY_SIZE,
		X.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
		X.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
		X.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		X.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		X.DS_RESOURCE,
		X.NR_NODES,
		X.NR_COMPUTING_UNITS_CPU,
		X.NR_COMPUTING_UNITS_GPU,
		X.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
		X.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
		X.NR_CONCAT_NODES_TOTAL_COMPUTING_UNITS_CPU_GPU,
		X.DS_DATASET,
		X.VL_DATASET_MEMORY_SIZE,
		X.DS_DATA_TYPE,
		X.VL_DATA_TYPE_MEMORY_SIZE,
		X.VL_DATASET_DIMENSION,
		X.VL_DATASET_ROW_DIMENSION,
		X.VL_DATASET_COLUMN_DIMENSION,
		X.VL_DATASET_ROW_X_COLUMN_DIMENSION,
		X.NR_RANDOM_STATE
	) Y
)
SELECT
T_CPU.DS_ALGORITHM,
T_CPU.DS_DATASET,
CASE
	WHEN T_CPU.DS_ALGORITHM = 'KMEANS'
		THEN
			CASE
				WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.3 THEN 0.4 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*5  || ')'
				WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.7 THEN 0.8 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*5  || ')'
				WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 1.5 THEN 1.6 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*5  || ')'
				WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 3.0 THEN 3.1 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*5  || ')'
				WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 6.2 THEN 6.3 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*5  || ')'
				ELSE ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*5  || ')'
			END
	WHEN T_CPU.DS_ALGORITHM = 'MATMUL_DISLIB'
		THEN
			CASE
				WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.3 THEN 0.4 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION + T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*(T_CPU.VL_GRID_ROW_DIMENSION-1)  || ')'
				WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.7 THEN 0.8 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION + T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*(T_CPU.VL_GRID_ROW_DIMENSION-1)  || ')'
				WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 1.5 THEN 1.6 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION + T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*(T_CPU.VL_GRID_ROW_DIMENSION-1)  || ')'
				WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 3.0 THEN 3.1 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION + T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*(T_CPU.VL_GRID_ROW_DIMENSION-1)  || ')'
				WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 6.2 THEN 6.3 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION + T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*(T_CPU.VL_GRID_ROW_DIMENSION-1)  || ')'
				ELSE ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION + T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*(T_CPU.VL_GRID_ROW_DIMENSION-1)   || ')'
			END
	ELSE
		'999999999999'
END AS CONCAT_BLOCK_PERCENT_DATASET_NR_TASKS,
CASE
WHEN (T_CPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC/T_GPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC) > 1.00 THEN (T_CPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC/T_GPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC)
ELSE -(T_GPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC/T_CPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC)
END AS SPEEDUP_GPU_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
CASE
WHEN (T_CPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC/T_GPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) > 1.00 THEN (T_CPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC/T_GPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC)
ELSE -(T_GPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC/T_CPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC)
END AS SPEEDUP_GPU_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
CASE
WHEN (T_CPU.VL_TOTAL_EXECUTION_TIME/T_GPU.VL_TOTAL_EXECUTION_TIME) > 1.00 THEN (T_CPU.VL_TOTAL_EXECUTION_TIME/T_GPU.VL_TOTAL_EXECUTION_TIME)
ELSE -(T_GPU.VL_TOTAL_EXECUTION_TIME/T_CPU.VL_TOTAL_EXECUTION_TIME)
END AS SPEEDUP_GPU_TOTAL_EXECUTION_TIME
FROM T_CPU INNER JOIN T_GPU ON (T_CPU.CD_PARAMETER = T_GPU.CD_PARAMETER)
WHERE
T_CPU.VL_GRID_ROW_DIMENSION = T_GPU.VL_GRID_ROW_DIMENSION
AND T_CPU.VL_GRID_COLUMN_DIMENSION = T_GPU.VL_GRID_COLUMN_DIMENSION
AND T_CPU.VL_BLOCK_ROW_DIMENSION = T_GPU.VL_BLOCK_ROW_DIMENSION
AND T_CPU.VL_BLOCK_COLUMN_DIMENSION = T_GPU.VL_BLOCK_COLUMN_DIMENSION
AND T_CPU.ds_dataset = 'S_32GB_1'
AND T_CPU.ds_parameter_type = 'VAR_GRID_SHAPE_MATMUL_1'
ORDER BY
T_CPU.DS_DATASET,
T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET




-- EXTRA FIGURE 2 - LARGER DATASETS - PART 2 - EXECUTION TIMES MATMUL
SELECT
DS_ALGORITHM,
DS_DEVICE,
CASE
	WHEN DS_ALGORITHM = 'KMEANS'
		THEN
			CASE
				WHEN ROUND(VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.3 THEN 0.4 || ' (' || VL_GRID_ROW_DIMENSION*5  || ')'
				WHEN ROUND(VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.7 THEN 0.8 || ' (' || VL_GRID_ROW_DIMENSION*5  || ')'
				WHEN ROUND(VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 1.5 THEN 1.6 || ' (' || VL_GRID_ROW_DIMENSION*5  || ')'
				WHEN ROUND(VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 3.0 THEN 3.1 || ' (' || VL_GRID_ROW_DIMENSION*5  || ')'
				WHEN ROUND(VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 6.2 THEN 6.3 || ' (' || VL_GRID_ROW_DIMENSION*5  || ')'
				ELSE ROUND(VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) || ' (' || VL_GRID_ROW_DIMENSION*5  || ')'
			END
	WHEN DS_ALGORITHM = 'MATMUL_DISLIB'
		THEN
			CASE
				WHEN ROUND(VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.3 THEN 0.4 || ' (' || VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION + VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION*(VL_GRID_ROW_DIMENSION-1)  || ')'
				WHEN ROUND(VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.7 THEN 0.8 || ' (' || VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION + VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION*(VL_GRID_ROW_DIMENSION-1)  || ')'
				WHEN ROUND(VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 1.5 THEN 1.6 || ' (' || VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION + VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION*(VL_GRID_ROW_DIMENSION-1)  || ')'
				WHEN ROUND(VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 3.0 THEN 3.1 || ' (' || VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION + VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION*(VL_GRID_ROW_DIMENSION-1)  || ')'
				WHEN ROUND(VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 6.2 THEN 6.3 || ' (' || VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION + VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION*(VL_GRID_ROW_DIMENSION-1)  || ')'
				ELSE ROUND(VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) || ' (' || VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION + VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION*(VL_GRID_ROW_DIMENSION-1)  || ')'
			END
	ELSE
		'999999999999'
END AS CONCAT_BLOCK_PERCENT_DATASET_NR_TASKS,
VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
VL_BLOCK_ROW_X_COLUMN_DIMENSION,
VL_GRID_ROW_X_COLUMN_DIMENSION,
VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC AS VL_USER_CODE_TIME,
VL_ADDITIONAL_TIME AS VL_SERIAL_FRACTION_TIME,
VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC AS VL_PARALLEL_FRACTION_TIME,
VL_COMMUNICATION_TIME AS VL_CPU_GPU_COMMUNICATION_TIME
FROM
(
	SELECT
		Y.VL_TOTAL_EXECUTION_TIME,
		Y.VL_INTER_TASK_EXECUTION_TIME,
		(Y.VL_INTER_TASK_EXECUTION_TIME - Y.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_INTER_TASK_OVERHEAD_TIME,
		Y.VL_INTER_TASK_EXECUTION_TIME - (Y.VL_INTER_TASK_EXECUTION_TIME - Y.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_INTER_TASK_EXECUTION_TIME_FREE_OVERHEAD,
		Y.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
		Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
		Y.VL_COMMUNICATION_TIME,
		Y.VL_ADDITIONAL_TIME,
		(Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC + Y.VL_COMMUNICATION_TIME) AS VL_INTRA_TASK_EXECUTION_TIME_FREE_ADDITIONAL,
		Y.CD_PARAMETER,
		Y.CD_CONFIGURATION,
		Y.ID_ALGORITHM,
		Y.DS_ALGORITHM,
		Y.ID_DEVICE,
		Y.DS_DEVICE,
		Y.ID_DATASET,
		Y.ID_RESOURCE,
		Y.ID_PARAMETER_TYPE,
		Y.DS_PARAMETER_TYPE,
		Y.DS_PARAMETER_ATTRIBUTE,
		Y.NR_ITERATIONS,
		Y.VL_GRID_ROW_DIMENSION,
		Y.VL_GRID_COLUMN_DIMENSION,
		Y.VL_GRID_ROW_X_COLUMN_DIMENSION,
		Y.VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
		Y.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
		Y.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
		Y.VL_BLOCK_ROW_DIMENSION,
		Y.VL_BLOCK_COLUMN_DIMENSION,
		Y.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
		Y.VL_BLOCK_MEMORY_SIZE,
		Y.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
		Y.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
		Y.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		Y.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		Y.DS_RESOURCE,
		Y.NR_NODES,
		Y.NR_COMPUTING_UNITS_CPU,
		(Y.NR_NODES-1)*Y.NR_COMPUTING_UNITS_CPU AS NR_TOTAL_COMPUTING_UNITS_CPU,
		(Y.NR_NODES-1) || ' (' || (Y.NR_NODES-1)*Y.NR_COMPUTING_UNITS_CPU || ')' AS NR_CONCAT_NODES_TOTAL_COMPUTING_UNITS_CPU,
		Y.NR_COMPUTING_UNITS_GPU,
		Y.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
		Y.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
		Y.DS_DATASET,
		Y.VL_DATASET_MEMORY_SIZE,
		Y.DS_DATA_TYPE,
		Y.VL_DATA_TYPE_MEMORY_SIZE,
		Y.VL_DATASET_DIMENSION,
		Y.VL_DATASET_ROW_DIMENSION,
		Y.VL_DATASET_COLUMN_DIMENSION,
		Y.VL_DATASET_ROW_X_COLUMN_DIMENSION,
		Y.NR_RANDOM_STATE
		FROM
		(
			SELECT
			AVG(X.VL_TOTAL_EXECUTION_TIME) AS VL_TOTAL_EXECUTION_TIME,
			AVG(X.VL_INTER_TASK_EXECUTION_TIME) AS VL_INTER_TASK_EXECUTION_TIME,
			AVG(X.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
			AVG(X.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
			AVG(X.VL_COMMUNICATION_TIME_1) AS VL_COMMUNICATION_TIME_1,
			AVG(X.VL_COMMUNICATION_TIME_2) AS VL_COMMUNICATION_TIME_2,
			AVG(X.VL_COMMUNICATION_TIME) AS VL_COMMUNICATION_TIME,
			AVG(X.VL_ADDITIONAL_TIME_1) AS VL_ADDITIONAL_TIME_1,
			AVG(X.VL_ADDITIONAL_TIME_2) AS VL_ADDITIONAL_TIME_2,
			AVG(X.VL_ADDITIONAL_TIME) AS VL_ADDITIONAL_TIME,
			X.CD_PARAMETER,
			X.CD_CONFIGURATION,
			X.ID_ALGORITHM,
			X.DS_ALGORITHM,
			X.ID_DEVICE,
			X.DS_DEVICE,
			X.ID_DATASET,
			X.ID_RESOURCE,
			X.ID_PARAMETER_TYPE,
			X.DS_PARAMETER_TYPE,
			X.DS_PARAMETER_ATTRIBUTE,
			X.NR_ITERATIONS,
			X.VL_GRID_ROW_DIMENSION,
			X.VL_GRID_COLUMN_DIMENSION,
			X.VL_GRID_ROW_X_COLUMN_DIMENSION,
			X.VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
			X.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
			X.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
			X.VL_BLOCK_ROW_DIMENSION,
			X.VL_BLOCK_COLUMN_DIMENSION,
			X.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
			X.VL_BLOCK_MEMORY_SIZE,
			X.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
			X.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
			X.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
			X.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
			X.DS_RESOURCE,
			X.NR_NODES,
			X.NR_COMPUTING_UNITS_CPU,
			X.NR_COMPUTING_UNITS_GPU,
			X.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
			X.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
			X.DS_DATASET,
			X.VL_DATASET_MEMORY_SIZE,
			X.DS_DATA_TYPE,
			X.VL_DATA_TYPE_MEMORY_SIZE,
			X.VL_DATASET_DIMENSION,
			X.VL_DATASET_ROW_DIMENSION,
			X.VL_DATASET_COLUMN_DIMENSION,
			X.VL_DATASET_ROW_X_COLUMN_DIMENSION,
			X.NR_RANDOM_STATE
			FROM
			(
				SELECT
					A.ID_EXPERIMENT,
					A.VL_TOTAL_EXECUTION_TIME,
					A.VL_INTER_TASK_EXECUTION_TIME,
					A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
					A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
					A.VL_COMMUNICATION_TIME_1,
					A.VL_COMMUNICATION_TIME_2,
					A.VL_COMMUNICATION_TIME_1 + A.VL_COMMUNICATION_TIME_2 AS VL_COMMUNICATION_TIME,
					A.VL_ADDITIONAL_TIME_1,
					A.VL_ADDITIONAL_TIME_2,
					A.VL_ADDITIONAL_TIME_1 + A.VL_ADDITIONAL_TIME_2 AS VL_ADDITIONAL_TIME,
					(A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC + A.VL_ADDITIONAL_TIME_1 + A.VL_ADDITIONAL_TIME_2) AS VL_INTRA_TASK_EXECUTION_TIME_FREE_ADDITIONAL,
					A.DT_PROCESSING,
					B.CD_PARAMETER,
					B.CD_CONFIGURATION,
					B.ID_ALGORITHM,
					(SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) AS DS_ALGORITHM,
					B.ID_FUNCTION,
					(SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_FUNCTION,
					(SELECT DISTINCT Y.ID_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS ID_DEVICE,
					(SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_DEVICE,
					B.ID_DATASET,
					B.ID_RESOURCE,
					B.ID_PARAMETER_TYPE,
					(SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_TYPE,
					(SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_ATTRIBUTE,
					B.NR_ITERATIONS,
					B.VL_GRID_ROW_DIMENSION,
					B.VL_GRID_COLUMN_DIMENSION,
					B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION AS VL_GRID_ROW_X_COLUMN_DIMENSION,
					B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION || ' (' || ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,0) || ')' AS VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
					ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) AS VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
					B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION || ' (' || ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
					B.VL_BLOCK_ROW_DIMENSION,
					B.VL_BLOCK_COLUMN_DIMENSION,
					B.VL_BLOCK_ROW_DIMENSION || ' x ' || B.VL_BLOCK_COLUMN_DIMENSION AS VL_BLOCK_ROW_X_COLUMN_DIMENSION,
					B.VL_BLOCK_MEMORY_SIZE,
					B.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
					B.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
					ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) AS VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
					ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ' (' || ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
					C.DS_RESOURCE,
					C.NR_NODES,
					C.NR_COMPUTING_UNITS_CPU,
					C.NR_COMPUTING_UNITS_GPU,
					C.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
					C.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
					D.DS_DATASET,
					D.VL_DATASET_MEMORY_SIZE,
					D.DS_DATA_TYPE,
					D.VL_DATA_TYPE_MEMORY_SIZE,
					D.VL_DATASET_DIMENSION,
					D.VL_DATASET_ROW_DIMENSION,
					D.VL_DATASET_COLUMN_DIMENSION,
					D.VL_DATASET_ROW_DIMENSION || ' x ' || D.VL_DATASET_COLUMN_DIMENSION AS VL_DATASET_ROW_X_COLUMN_DIMENSION,
					D.NR_RANDOM_STATE
				FROM EXPERIMENT_RAW A
				INNER JOIN PARAMETER B ON (A.ID_PARAMETER = B.ID_PARAMETER)
				INNER JOIN RESOURCE C ON (B.ID_RESOURCE = C.ID_RESOURCE)
				INNER JOIN DATASET D ON (B.ID_DATASET = D.ID_DATASET)
				WHERE
				A.ID_EXPERIMENT NOT IN (370685,370675,370662,370681,370667,370670,370676,370652,370679,370669) -- GRID ROW DIM 16
				AND A.ID_EXPERIMENT NOT IN (380224,380190,380234,380233,380206,380248,380156,380152,380151,380158) -- GRID ROW DIM 8
				AND A.ID_EXPERIMENT NOT IN (362026,362018,362024,362037,362036,362028,362032,362029,362023,362052) -- GRID ROW DIM 4
			) X
			GROUP BY
			X.CD_PARAMETER,
			X.CD_CONFIGURATION,
			X.ID_ALGORITHM,
			X.DS_ALGORITHM,
			X.ID_DEVICE,
			X.DS_DEVICE,
			X.ID_DATASET,
			X.ID_RESOURCE,
			X.ID_PARAMETER_TYPE,
			X.DS_PARAMETER_TYPE,
			X.DS_PARAMETER_ATTRIBUTE,
			X.NR_ITERATIONS,
			X.VL_GRID_ROW_DIMENSION,
			X.VL_GRID_COLUMN_DIMENSION,
			X.VL_GRID_ROW_X_COLUMN_DIMENSION,
			X.VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
			X.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
			X.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
			X.VL_BLOCK_ROW_DIMENSION,
			X.VL_BLOCK_COLUMN_DIMENSION,
			X.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
			X.VL_BLOCK_MEMORY_SIZE,
			X.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
			X.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
			X.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
			X.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
			X.DS_RESOURCE,
			X.NR_NODES,
			X.NR_COMPUTING_UNITS_CPU,
			X.NR_COMPUTING_UNITS_GPU,
			X.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
			X.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
			X.DS_DATASET,
			X.VL_DATASET_MEMORY_SIZE,
			X.DS_DATA_TYPE,
			X.VL_DATA_TYPE_MEMORY_SIZE,
			X.VL_DATASET_DIMENSION,
			X.VL_DATASET_ROW_DIMENSION,
			X.VL_DATASET_COLUMN_DIMENSION,
			X.VL_DATASET_ROW_X_COLUMN_DIMENSION,
			X.NR_RANDOM_STATE
		) Y
) ZZ
WHERE
ZZ.ds_algorithm='MATMUL_DISLIB'
AND ZZ.ds_dataset = 'S_32GB_1'
AND ZZ.ds_parameter_type = 'VAR_GRID_SHAPE_MATMUL_1'
AND ZZ.ds_device = 'GPU'
ORDER BY
DS_DEVICE,
VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
DS_ALGORITHM DESC
